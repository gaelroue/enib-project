<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Atmel Corporation - Software Examples</title>
  <link rel="stylesheet" type="text/css" href="../style.css" />
</head>
<body>
<div id="body">
<h1>AT91SAM9261-EK development board</h1>
<div id="banner"></div>
<div id="contents">
  <table>
  <tr><th>Control ds7 led</th></tr>
  <tr><td>
    <input type="checkbox" id="ds7" onclick="do_onclick(this, document.getElementById('ds7Label'))"><span id="ds7Label"> Led ds7 éteinte</span>
  </td></tr>
  </table>
  <table>
  <tr><th>Action result</th></tr>
  <tr><td><b>Status:</b><span id="A1"></span></td></tr>
  <tr><td><b>Response:</b>
  	<p><span id="A2"></span></p>
  </td></tr>
  </table>
</div>
</div>
<script>
function updateLabel(led, label) {
  if (led.checked) {
    label.innerHTML=" Led allumée";
  } else {
    label.innerHTML=" Led éteinte";
  } 
}

function do_onclick(led, label)
{
  // new XMLHttpRequest
  var xmlhttp=new XMLHttpRequest();
  
  // register callback : function to be called when we receive the response
  xmlhttp.onreadystatechange=function() {
    if (xmlhttp.readyState==4 && xmlhttp.status==200) {
      updateLabel(led, label);
      document.getElementById('A1').innerHTML=xmlhttp.status + " - " + xmlhttp.statusText;
      document.getElementById('A2').innerHTML=xmlhttp.responseText;
    }
  }
  
  // send request and poll for asynchronous response
  xmlhttp.open("GET","cgi-bin/test5.lua?"+led.id+"="+led.checked,true);
  xmlhttp.send();
}

// initial checkbox state, reflect this state on the target
var led=document.getElementById("ds7");
var label=document.getElementById("ds7Label");

led.checked=false;
do_onclick(led, label);
</script>
</body>
</html>
